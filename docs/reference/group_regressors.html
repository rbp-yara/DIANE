<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Group correlated regulators — group_regressors • DIANE</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Group correlated regulators — group_regressors"><meta property="og:description" content="During network inference, the importance of regressors is assessed for aech target gene.
But regression methods are very sensitive to correlation between predictive variables, that should be 
dealt with for stability reasons.
To account for this, this function summarizes the expression of the regulators being correlated above
a certain threshold as new variables, being the mean of several correlated profiles.
To do so, a graph of all regressors correlated (spearman) above the threshold id built, and groups
are formed with a community detection algorithm. Each group is then averaged in a single variable.
Strongly negatively correlated regressors are added to the group it is correlated to, but their expression
is not taken into account in the summary mean profile."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DIANE</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/DIANE.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/DIANE_Input_data.html">Data upload</a>
    </li>
    <li>
      <a href="../articles/DIANE_Programming_Interface.html">DIANE Programming Interface</a>
    </li>
    <li>
      <a href="../articles/DIANE_normalize.html">Normalization</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/OceaneCsn/DIANE/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Group correlated regulators</h1>
    <small class="dont-index">Source: <a href="https://github.com/OceaneCsn/DIANE/blob/HEAD/R/fct_regressors_grouping.R" class="external-link"><code>R/fct_regressors_grouping.R</code></a></small>
    <div class="hidden name"><code>group_regressors.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>During network inference, the importance of regressors is assessed for aech target gene.
But regression methods are very sensitive to correlation between predictive variables, that should be 
dealt with for stability reasons.
To account for this, this function summarizes the expression of the regulators being correlated above
a certain threshold as new variables, being the mean of several correlated profiles.</p>
<p>To do so, a graph of all regressors correlated (spearman) above the threshold id built, and groups
are formed with a community detection algorithm. Each group is then averaged in a single variable.
Strongly negatively correlated regressors are added to the group it is correlated to, but their expression
is not taken into account in the summary mean profile.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">group_regressors</span><span class="op">(</span><span class="va">normalized.count</span>, <span class="va">genes</span>, <span class="va">regressors</span>, corr_thr <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>normalized.count</dt>
<dd><p>normalized expression matrix containing genes and regressors.</p></dd>


<dt>genes</dt>
<dd><p>target genes that want to be used in the inference process</p></dd>


<dt>regressors</dt>
<dd><p>regressor genes to be used in the inference process.</p></dd>


<dt>corr_thr</dt>
<dd><p>correlation threshold to be used for regressors grouping.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a named list.</p>



<p>counts : the normalized expression data containing the new summarized variables, in
the format mean_geneID1-geneID2... The individual genes that were grouped are removed.</p>



<p>correlated_regressors_graph : visNetwork data
 of the correlated regulators</p>



<p>grouped_genes : new vector of target genes, with individual correlated genes replaced by groups</p>



<p>grouped_regressors : new vector of regressors, with individual correlated genes replaced by groups</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">abiotic_stresses</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aggregated_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate_splice_variants.html">aggregate_splice_variants</a></span><span class="op">(</span><span class="va">abiotic_stresses</span><span class="op">$</span><span class="va">normalized_counts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_locus.html">get_locus</a></span><span class="op">(</span><span class="va">abiotic_stresses</span><span class="op">$</span><span class="va">heat_DEGs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">regressors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">genes</span>, <span class="va">regulators_per_organism</span><span class="op">[[</span><span class="st">"Arabidopsis thaliana"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">grouping</span> <span class="op">&lt;-</span> <span class="fu">DIANE</span><span class="fu">::</span><span class="fu">group_regressors</span><span class="op">(</span><span class="va">aggregated_data</span>, <span class="va">genes</span>, <span class="va">regressors</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "adding tf  AT1G74890  to group  2 because correlation of -0.912173913043478 to mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "adding tf  AT5G59570  to group  4 because correlation of -0.919130434782609 to mean"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">grouping</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "counts"                      "correlated_regressors_graph"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "grouped_genes"               "grouped_regressors"         </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://oceanecsn.github.io/" class="external-link">Océane Cassan</a>, Alexandre Soriano.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

