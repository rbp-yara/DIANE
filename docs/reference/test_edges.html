<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Statistical edges testing by permutations — test_edges • DIANE</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Statistical edges testing by permutations — test_edges"><meta property="og:description" content="We designed a method to perform statistical testing on TF-target gene pairs
from the Random Forest regulatory weights inference.
The idea is to build a first biologically relevant network with the
strongest importances given by a prior GENIE3 run, that would then be
refined by statistical testing.
Those tests are performed by the rfPermute package, providing empirical
pvalues on observed importance values from response variable permutations."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DIANE</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/DIANE.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/DIANE_Input_data.html">Data upload</a>
    </li>
    <li>
      <a href="../articles/DIANE_Programming_Interface.html">DIANE Programming Interface</a>
    </li>
    <li>
      <a href="../articles/DIANE_normalize.html">Normalization</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/OceaneCsn/DIANE/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Statistical edges testing by permutations</h1>
    <small class="dont-index">Source: <a href="https://github.com/OceaneCsn/DIANE/blob/HEAD/R/fct_edge_testing.R" class="external-link"><code>R/fct_edge_testing.R</code></a></small>
    <div class="hidden name"><code>test_edges.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>We designed a method to perform statistical testing on TF-target gene pairs
from the Random Forest regulatory weights inference.
The idea is to build a first biologically relevant network with the
strongest importances given by a prior GENIE3 run, that would then be
refined by statistical testing.
Those tests are performed by the rfPermute package, providing empirical
pvalues on observed importance values from response variable permutations.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">test_edges</span><span class="op">(</span></span>
<span>  <span class="va">mat</span>,</span>
<span>  <span class="va">normalized_counts</span>,</span>
<span>  <span class="va">nGenes</span>,</span>
<span>  <span class="va">nRegulators</span>,</span>
<span>  density <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>  nTrees <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  nShuffle <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  nCores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mat</dt>
<dd><p>matrix containing the importance values for each target and regulator
(preferably computed with GENIE3 and the OOB importance metric)</p></dd>


<dt>normalized_counts</dt>
<dd><p>normalized expression data containing the genes present in
mat argument, and such as used for the first network inference step.</p></dd>


<dt>nGenes</dt>
<dd><p>number of total genes in the network, union of thetarget genes,
and regulators</p></dd>


<dt>nRegulators</dt>
<dd><p>number of regulators used for the network inference step</p></dd>


<dt>density</dt>
<dd><p>approximate desired density, that will be used to build
a first network, which edges are the one to be statistically tested. Default
is 0.02. Biological networks are known to have densities (ratio of edges over
total possible edges in the graph) between 0.1 and 0.001.
The number of genes and regulators are needed to compute the density.</p></dd>


<dt>nTrees</dt>
<dd><p>number of trees used for random forest importance computations</p></dd>


<dt>nShuffle</dt>
<dd><p>number of times the response variable (target gene expression)
is randomized in order to estimate the null distribution of the
predictive variables (regulators) importances.</p></dd>


<dt>nCores</dt>
<dd><p>Number of CPU cores to use during the procedure.
Default is the detected number of cores minus one.</p></dd>


<dt>verbose</dt>
<dd><p>If set to TRUE, a feedback on the progress of the calculations
is given. Default: TRUE</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>named list containing the edges pvalues, as well as graphics
intended to guide the choice of a pvalue threshold for the final network:</p><ul><li><p>links: a dataframe containing the links of the network before testing,
as built from the user defined prior density. All edges are associated to their
pvalue and fdr-adjusted pvalue.</p></li>
<li><p>fdr_nEdges_curve : relation between the fdr threshold, and the final
number of edges in the final network</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"abiotic_stresses"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"gene_annotations"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"regulators_per_organism"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_locus.html">get_locus</a></span><span class="op">(</span><span class="va">abiotic_stresses</span><span class="op">$</span><span class="va">heat_DEGs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">regressors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">genes</span>, </span></span>
<span class="r-in"><span>                        <span class="va">regulators_per_organism</span><span class="op">$</span><span class="va">`Arabidopsis thaliana`</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate_splice_variants.html">aggregate_splice_variants</a></span><span class="op">(</span><span class="va">abiotic_stresses</span><span class="op">$</span><span class="va">normalized_counts</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">DIANE</span><span class="fu">::</span><span class="fu"><a href="group_regressors.html">group_regressors</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">genes</span>, <span class="va">regressors</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu">DIANE</span><span class="fu">::</span><span class="fu"><a href="network_inference.html">network_inference</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">counts</span>, </span></span>
<span class="r-in"><span>                                conds <span class="op">=</span> <span class="va">abiotic_stresses</span><span class="op">$</span><span class="va">conditions</span>, </span></span>
<span class="r-in"><span>                                targets <span class="op">=</span> <span class="va">r</span><span class="op">$</span><span class="va">grouped_genes</span>,</span></span>
<span class="r-in"><span>                                regressors <span class="op">=</span> <span class="va">r</span><span class="op">$</span><span class="va">grouped_regressors</span>, </span></span>
<span class="r-in"><span>                                importance_metric <span class="op">=</span> <span class="st">"MSEincrease_oob"</span>, </span></span>
<span class="r-in"><span>                                verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">DIANE</span><span class="fu">::</span><span class="fu">test_edges</span><span class="op">(</span><span class="va">mat</span>, normalized_counts <span class="op">=</span> <span class="va">r</span><span class="op">$</span><span class="va">counts</span>, density <span class="op">=</span> <span class="fl">0.02</span>,</span></span>
<span class="r-in"><span>                        nGenes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">grouped_genes</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                        nRegulators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">grouped_regressors</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                        nTrees <span class="op">=</span> <span class="fl">1000</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://oceanecsn.github.io/" class="external-link">Océane Cassan</a>, Alexandre Soriano.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

