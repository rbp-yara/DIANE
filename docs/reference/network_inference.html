<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Regulatory importances estimation via Random Forests — network_inference • DIANE</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Regulatory importances estimation via Random Forests — network_inference"><meta property="og:description" content="GENIE3 needs to be given a list of genes, that will be the nodes of the inferred network. 
Among those genes, some must be considered as potential regulators. 
GENIE3 can determine the influence if every regulators over each input genes, 
using their respective expression profiles. You can specify which conditions 
you want to be considered for those profiles during the network inference.
For each target gene, the methods uses Random Forests to provide a ranking of all 
regulators based on their influence on the target expression. This ranking is then merged 
across all targets, giving a global regulatory links ranking stored in the result matrix."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DIANE</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/DIANE.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/DIANE_Input_data.html">Data upload</a>
    </li>
    <li>
      <a href="../articles/DIANE_Programming_Interface.html">DIANE Programming Interface</a>
    </li>
    <li>
      <a href="../articles/DIANE_normalize.html">Normalization</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/OceaneCsn/DIANE/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Regulatory importances estimation via Random Forests</h1>
    <small class="dont-index">Source: <a href="https://github.com/OceaneCsn/DIANE/blob/HEAD/R/fct_network_inference.R" class="external-link"><code>R/fct_network_inference.R</code></a></small>
    <div class="hidden name"><code>network_inference.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>GENIE3 needs to be given a list of genes, that will be the nodes of the inferred network. 
Among those genes, some must be considered as potential regulators. 
GENIE3 can determine the influence if every regulators over each input genes, 
using their respective expression profiles. You can specify which conditions 
you want to be considered for those profiles during the network inference.
For each target gene, the methods uses Random Forests to provide a ranking of all 
regulators based on their influence on the target expression. This ranking is then merged 
across all targets, giving a global regulatory links ranking stored in the result matrix.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">network_inference</span><span class="op">(</span></span>
<span>  <span class="va">normalized.count</span>,</span>
<span>  <span class="va">conds</span>,</span>
<span>  <span class="va">regressors</span>,</span>
<span>  <span class="va">targets</span>,</span>
<span>  nTrees <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  nCores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  importance_metric <span class="op">=</span> <span class="st">"node_purity"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>normalized.count</dt>
<dd><p>normalized expression matrix containing the regressors and target genes
in its rows, and samples a columns</p></dd>


<dt>conds</dt>
<dd><p>condition names to be used in the inference (not columns names, conditions names
before the underscore)</p></dd>


<dt>regressors</dt>
<dd><p>genes to be taken as regressors during the inference procedures (regulator genes)</p></dd>


<dt>targets</dt>
<dd><p>genes to be included in the inferred network. Regressors can also be in the targets</p></dd>


<dt>nTrees</dt>
<dd><p>Number of trees by Random Forest</p></dd>


<dt>nCores</dt>
<dd><p>Number of CPU cores to use during the procedure. Default is the detected number of cores
minus one.</p></dd>


<dt>verbose</dt>
<dd><p>If set to TRUE, a feedback on the progress of the calculations is given. Default: TRUE</p></dd>


<dt>importance_metric</dt>
<dd><p>character being either node_purity or MSEincrease_oob. This is the importance type
computed for the regulator-gene pairs, as returned by the randomForest package.  Default is node_purity,
the metric used in GENIE3. Our improvement of the method uses MSEincrease_oob for consistency reasons regarding
to statistical edges testing. The default one is around 4 times fatser, but more sensitive to the number of
 regulators and to over-fitting. Too few samples will lead to NA in MSEincrease_oob, so in that case, it is
 advised to used GENIE3's default one.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Matrix filled with regulator-target regulatory weights</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"abiotic_stresses"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"regulators_per_organism"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">aggregated_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="aggregate_splice_variants.html">aggregate_splice_variants</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">abiotic_stresses</span><span class="op">$</span><span class="va">normalized_counts</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_locus.html">get_locus</a></span><span class="op">(</span><span class="va">abiotic_stresses</span><span class="op">$</span><span class="va">heat_DEGs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">regressors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">genes</span>, <span class="va">regulators_per_organism</span><span class="op">[[</span><span class="st">"Arabidopsis thaliana"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu">network_inference</span><span class="op">(</span><span class="va">aggregated_data</span>, conds <span class="op">=</span> <span class="va">abiotic_stresses</span><span class="op">$</span><span class="va">conditions</span>, </span></span>
<span class="r-in"><span>targets <span class="op">=</span> <span class="va">genes</span>, regressors <span class="op">=</span> <span class="va">regressors</span>, nTrees <span class="op">=</span> <span class="fl">1000</span>, nCores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://oceanecsn.github.io/" class="external-link">Océane Cassan</a>, Alexandre Soriano.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

